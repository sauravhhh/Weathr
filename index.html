<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Weathr - 5 Day Forecast</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
      color: #2d3436;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      width: 100%;
      max-width: 380px;
      padding: 25px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12);
      display: flex;
      flex-direction: column;
      gap: 18px;
    }
    h1 {
      font-size: 1.8rem;
      font-weight: 800;
      text-align: center;
      color: #1a1a1e;
      margin-bottom: 8px;
    }
    .location-input {
      width: 100%;
      padding: 14px 18px;
      font-size: 1rem;
      border: 1px solid #dadce0;
      border-radius: 25px;
      outline: none;
      margin-bottom: 20px;
      transition: border-color 0.3s ease;
      background: #fff;
    }
    .location-input::placeholder {
      color: #80868b;
    }
    .location-input:focus {
      border-color: #1a73e8;
      box-shadow: 0 0 8px rgba(26, 115, 232, 0.2);
    }
    .search-btn {
      width: 100%;
      background: #1a73e8;
      color: white;
      border: none;
      border-radius: 25px;
      padding: 14px 0;
      font-weight: 500;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
      letter-spacing: 0.8px;
    }
    .search-btn:hover {
      background: #1565c0;
    }
    .loading {
      color: #5f6368;
      margin: 20px 0;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      display: none;
    }
    .loading-spinner {
      width: 18px;
      height: 18px;
      border: 2px solid #5f6368;
      border-top: 2px solid transparent;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .error {
      color: #ea4335;
      background: rgba(234, 67, 53, 0.1);
      padding: 12px 20px;
      border-radius: 12px;
      margin: 20px 0;
      font-size: 0.9rem;
      font-weight: 500;
      display: none;
    }
    .current-weather {
      text-align: center;
      background: rgba(116, 185, 255, 0.15);
      border-radius: 16px;
      padding: 22px;
    }
    .location-name {
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 4px;
      color: #2d3436;
    }
    .current-datetime {
      font-size: 0.95rem;
      color: #636e72;
      margin-bottom: 12px;
      font-weight: 500;
    }
    .weather-icon {
      font-size: 3.5rem;
      margin: 12px 0;
    }
    .temp-main {
      font-size: 3.2rem;
      font-weight: 300;
      color: #007AFF;
      margin: 12px 0;
    }
    .weather-desc {
      font-size: 1.1rem;
      color: #636e72;
      margin-bottom: 18px;
      text-transform: capitalize;
    }
    .weather-details {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .detail-card {
      background: rgba(255, 255, 255, 0.7);
      padding: 12px;
      border-radius: 12px;
      text-align: center;
    }
    .detail-label {
      font-size: 0.85rem;
      color: #636e72;
      margin-bottom: 4px;
    }
    .detail-value {
      font-size: 1.1rem;
      font-weight: 700;
      color: #2d3436;
    }
    .forecast-container {
      margin-top: 24px;
    }
    .forecast-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: #2d3436;
      margin-bottom: 16px;
      text-align: center;
    }
    .forecast-day {
      background: rgba(255, 255, 255, 0.85);
      border-radius: 14px;
      padding: 16px;
      margin-bottom: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }
    .day-info {
      flex: 1;
    }
    .day-name {
      font-size: 1.1rem;
      font-weight: 600;
      color: #2d3436;
      margin-bottom: 2px;
    }
    .day-date {
      font-size: 0.9rem;
      color: #636e72;
    }
    .day-temps {
      flex: 1;
      text-align: center;
    }
    .temp-high {
      font-size: 1.2rem;
      font-weight: 700;
      color: #e17055;
    }
    .temp-low {
      font-size: 1rem;
      color: #636e72;
    }
    .day-details {
      flex: 1.5;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 6px;
      font-size: 0.8rem;
    }
    .mini-detail {
      text-align: center;
      padding: 6px;
      background: rgba(116, 185, 255, 0.12);
      border-radius: 8px;
      color: #2d3436;
      font-weight: 500;
    }
    .footer {
      margin: 32px 0 8px;
      text-align: center;
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.85);
      font-weight: 500;
    }
    .weather-section {
      display: none;
    }
    @media (max-width: 480px) {
      .container {
        max-width: 95vw;
        padding: 20px;
      }
      .temp-main {
        font-size: 2.8rem;
      }
      .day-details {
        grid-template-columns: 1fr;
        gap: 4px;
      }
      .mini-detail {
        font-size: 0.75rem;
        padding: 4px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Weathr</h1>
    
    <input type="text" class="location-input" id="cityInput" placeholder="Enter place (e.g. New York, Delhi etc)" />
    <button class="search-btn" id="getWeatherBtn">Get Weather</button>
    
    <div class="loading" id="loadingState">
      <div class="loading-spinner"></div>
      Loading weather data...
    </div>
    <div class="error" id="errorState"></div>
    
    <div class="weather-section" id="weatherSection">
      <div class="current-weather">
        <div class="location-name" id="locationName">-</div>
        <div class="current-datetime" id="currentDateTime">-</div>
        <div class="weather-icon" id="weatherIcon">üå§Ô∏è</div>
        <div class="temp-main" id="tempMain">-¬∞C</div>
        <div class="weather-desc" id="weatherDesc">-</div>
        
        <div class="weather-details">
          <div class="detail-card">
            <div class="detail-label">Humidity</div>
            <div class="detail-value" id="humidityValue">-%</div>
          </div>
          <div class="detail-card">
            <div class="detail-label">Wind</div>
            <div class="detail-value" id="windValue">- km/h</div>
          </div>
          <div class="detail-card">
            <div class="detail-label">Pressure</div>
            <div class="detail-value" id="pressureValue">- hPa</div>
          </div>
          <div class="detail-card">
            <div class="detail-label">UV Index</div>
            <div class="detail-value" id="uvValue">-</div>
          </div>
        </div>
      </div>
      
      <div class="forecast-container">
        <div class="forecast-title">5-Day Forecast</div>
        <div id="forecastList"></div>
      </div>
    </div>
  </div>
  
  <div class="footer">Made with ‚ù§Ô∏è by sauravhhh</div>

  <script>
    const cityInput = document.getElementById('cityInput');
    const getWeatherBtn = document.getElementById('getWeatherBtn');
    const loadingState = document.getElementById('loadingState');
    const errorState = document.getElementById('errorState');
    const weatherSection = document.getElementById('weatherSection');
    
    const locationName = document.getElementById('locationName');
    const currentDateTime = document.getElementById('currentDateTime');
    const weatherIcon = document.getElementById('weatherIcon');
    const tempMain = document.getElementById('tempMain');
    const weatherDesc = document.getElementById('weatherDesc');
    const humidityValue = document.getElementById('humidityValue');
    const windValue = document.getElementById('windValue');
    const pressureValue = document.getElementById('pressureValue');
    const uvValue = document.getElementById('uvValue');
    const forecastList = document.getElementById('forecastList');

    // Store timezone offset for location-based time updates
    let currentTimezoneOffset = 0;
    let locationTimezone = '';

    const weatherIcons = {
      0: '‚òÄÔ∏è', 1: 'üå§Ô∏è', 2: '‚õÖ', 3: '‚òÅÔ∏è', 45: 'üå´Ô∏è', 48: 'üå´Ô∏è',
      51: 'üå¶Ô∏è', 53: 'üå¶Ô∏è', 55: 'üåßÔ∏è', 61: 'üåßÔ∏è', 63: 'üåßÔ∏è', 65: 'üåßÔ∏è',
      71: '‚ùÑÔ∏è', 73: '‚ùÑÔ∏è', 75: '‚ùÑÔ∏è', 80: 'üå¶Ô∏è', 81: 'üåßÔ∏è', 82: '‚õàÔ∏è',
      95: '‚õàÔ∏è', 96: '‚õàÔ∏è', 99: '‚õàÔ∏è'
    };

    const weatherDescriptions = {
      0: 'Clear sky', 1: 'Mainly clear', 2: 'Partly cloudy', 3: 'Overcast',
      45: 'Fog', 48: 'Depositing rime fog', 51: 'Light drizzle', 53: 'Moderate drizzle',
      55: 'Dense drizzle', 61: 'Slight rain', 63: 'Moderate rain', 65: 'Heavy rain',
      71: 'Slight snow', 73: 'Moderate snow', 75: 'Heavy snow',
      80: 'Slight rain showers', 81: 'Moderate rain showers', 82: 'Violent rain showers',
      95: 'Thunderstorm', 96: 'Thunderstorm with hail', 99: 'Thunderstorm with heavy hail'
    };

    function getLocationDateTime(timezoneOffsetSeconds) {
      const now = new Date();
      // Get UTC time and add the location's timezone offset
      const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
      const localTime = new Date(utc + (timezoneOffsetSeconds * 1000));
      
      const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
      
      const dayName = dayNames[localTime.getDay()];
      const day = localTime.getDate();
      const monthName = monthNames[localTime.getMonth()];
      const year = localTime.getFullYear();
      const hour = localTime.getHours();
      const minute = localTime.getMinutes();
      
      // Convert to 12-hour format
      const displayHour = hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;
      const period = hour < 12 ? 'AM' : 'PM';
      const displayMinute = minute.toString().padStart(2, '0');
      
      // Add ordinal suffix to day
      const getOrdinal = (n) => {
        const s = ["th", "st", "nd", "rd"];
        const v = n % 100;
        return n + (s[(v - 20) % 10] || s[v] || s[0]);
      };
      
      return `${dayName}, ${getOrdinal(day)} ${monthName} ${year} (${displayHour}:${displayMinute} ${period})`;
    }

    // Update time every minute using the stored timezone offset
    function updateDateTime() {
      if (currentDateTime.textContent !== '-' && currentTimezoneOffset !== null) {
        currentDateTime.textContent = getLocationDateTime(currentTimezoneOffset);
      }
    }

    // Update time every 60 seconds
    setInterval(updateDateTime, 60000);

    async function getCoordinates(cityName) {
      const response = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(cityName)}&count=1&language=en&format=json`);
      const data = await response.json();
      
      if (data.results && data.results.length > 0) {
        const result = data.results[0];
        return {
          lat: result.latitude,
          lon: result.longitude,
          name: result.name,
          country: result.country || ''
        };
      } else {
        throw new Error('City not found');
      }
    }

    async function getWeatherData(lat, lon) {
      const response = await fetch(
        `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m,surface_pressure&daily=weather_code,temperature_2m_max,temperature_2m_min,uv_index_max,wind_speed_10m_max,relative_humidity_2m_mean&timezone=auto&forecast_days=5`
      );
      
      if (!response.ok) {
        throw new Error('Weather data not available');
      }
      
      return await response.json();
    }

    function displayCurrentWeather(data, coords) {
      const current = data.current;
      
      // Store timezone offset from API response
      currentTimezoneOffset = data.utc_offset_seconds || 0;
      locationTimezone = data.timezone || '';
      
      locationName.textContent = `${coords.name}${coords.country ? ', ' + coords.country : ''}`;
      currentDateTime.textContent = getLocationDateTime(currentTimezoneOffset);
      weatherIcon.textContent = weatherIcons[current.weather_code] || 'üå§Ô∏è';
      tempMain.textContent = `${Math.round(current.temperature_2m)}¬∞C`;
      weatherDesc.textContent = weatherDescriptions[current.weather_code] || 'Unknown';
      
      humidityValue.textContent = `${current.relative_humidity_2m}%`;
      windValue.textContent = `${Math.round(current.wind_speed_10m)} km/h`;
      pressureValue.textContent = `${Math.round(current.surface_pressure)} hPa`;
      uvValue.textContent = Math.round(data.daily.uv_index_max[0]) || 'N/A';
    }

    function displayForecast(data) {
      forecastList.innerHTML = '';
      const dayNamesShort = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      
      for (let i = 0; i < 5; i++) {
        const date = new Date(data.daily.time[i]);
        const dayName = i === 0 ? 'Today' : dayNamesShort[date.getDay()];
        const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        
        const forecastDay = document.createElement('div');
        forecastDay.className = 'forecast-day';
        
        const windVal = data.daily.wind_speed_10m_max[i] ? Math.round(data.daily.wind_speed_10m_max[i]) : 'N/A';
        const humidVal = data.daily.relative_humidity_2m_mean[i] ? Math.round(data.daily.relative_humidity_2m_mean[i]) : 'N/A';
        
        forecastDay.innerHTML = `
          <div class="day-info">
            <div class="day-name">${dayName}</div>
            <div class="day-date">${dateStr}</div>
          </div>
          <div class="day-temps">
            <div class="temp-high">${Math.round(data.daily.temperature_2m_max[i])}¬∞</div>
            <div class="temp-low">${Math.round(data.daily.temperature_2m_min[i])}¬∞</div>
          </div>
          <div class="day-details">
            <div class="mini-detail">üí® ${windVal} km/h</div>
            <div class="mini-detail">üíß ${humidVal}%</div>
          </div>
        `;
        
        forecastList.appendChild(forecastDay);
      }
    }

    function showLoading() {
      loadingState.style.display = 'flex';
      errorState.style.display = 'none';
      weatherSection.style.display = 'none';
    }

    function hideLoading() {
      loadingState.style.display = 'none';
    }

    function showError(message) {
      errorState.textContent = message;
      errorState.style.display = 'block';
      weatherSection.style.display = 'none';
      hideLoading();
    }

    function showWeather() {
      weatherSection.style.display = 'block';
      errorState.style.display = 'none';
      hideLoading();
    }

    async function fetchWeather() {
      const city = cityInput.value.trim();
      if (!city) {
        showError('Please enter a place name');
        return;
      }

      showLoading();

      try {
        const coords = await getCoordinates(city);
        const weatherData = await getWeatherData(coords.lat, coords.lon);
        
        displayCurrentWeather(weatherData, coords);
        displayForecast(weatherData);
        showWeather();
      } catch (error) {
        showError(error.message);
      }
    }

    getWeatherBtn.addEventListener('click', fetchWeather);
    cityInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        fetchWeather();
      }
    });
  </script>
</body>
</html>
